<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>FCCSW</title>
  <meta name="description" content="Main page for documentation and resources.">

  <link rel="stylesheet" href="http://fccsw.web.cern.ch/fccsw/css/main.css">
  <link rel="canonical" href="http://fccsw.web.cern.ch/fccsw/tutorials/fcc-tutorials/FccPythiaDelphes.html">
  <link rel="alternate" type="application/rss+xml" title="FCCSW" href="http://fccsw.web.cern.ch/fccsw/feed.xml">
</head>


  <body>

    
<header>
   <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://fccsw.web.cern.ch/fccsw/index.html">FCCSW</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li ><a href="http://fccsw.web.cern.ch/fccsw/index.html">Home</a></li>
            <li  class="active" ><a href="http://fccsw.web.cern.ch/fccsw/tutorials">Tutorials</a></li>
            <li><a>Latest Releases:</a></li>
            
            
              
            
              
              <li >
                <a href="http://fccsw.web.cern.ch/fccsw/2016/11/01/version08pre.html">FCCSW v0.8pre</a>
              </li>
              
            
              
              <li >
                <a href="http://fccsw.web.cern.ch/fccsw/2016/08/16/version07.html">FCCSW v0.7</a>
              </li>
              
            
            <li ><a href="http://fccsw.web.cern.ch/fccsw/snapshot.html">Snapshot</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

</header>

    
    
    <div class="container">
      <div class="col-md-10">
        <h1 id="fcc-pythia--delphes-analysis-documentation"><a href=""></a> FCC Pythia + Delphes Analysis (Documentation)</h1>

<p>Contents</p>

<ul>
  <li><a href="#fcc-pythia-delphes-analysis-docu">FCC Pythia + Delphes
Analysis (Documentation)</a>
    <ul>
      <li><a href="#overview">Overview</a></li>
      <li><a href="#installation-procedure">Installation Procedure</a></li>
      <li><a href="#how-to-run">How to Run?</a></li>
      <li><a href="#fcc-edm-output">FCC-EDM output</a></li>
      <li><a href="#other-documentation">Other documentation</a></li>
    </ul>
  </li>
</ul>

<h2 id="overview"><a href=""></a> Overview</h2>

<p><strong>A small tutorial on how to study FCC-hh benchmark channels</strong> within
the <strong><a href="https://github.com/HEP-FCC/FCCSW" title="FCCSW framework">FCCSW
framework</a></strong> with
<strong><a href="http://home.thep.lu.se/~torbjorn/pythia81html/Welcome.html" title="Pythia">Pythia</a></strong>
generator and <strong><a href="https://cp3.irmp.ucl.ac.be/projects/delphes">Delphes</a></strong>
simulation.</p>

<p>Input/Output:</p>

<ul>
  <li>The Pythia input is required through
<a href="https://en.wikipedia.org/wiki/Les_Houches_Accords" title="Les Houches Event">LHE</a>
(Les Houches Event) data file together with a special Pythia config
file or just standard Pythia config file (for details see below).</li>
  <li>
    <p>The Pythia output is through transient memory data store using
<a href="http://lcgapp.cern.ch/project/simu/HepMC/" title="HepMC">HepMC</a> event
data format.</p>
  </li>
  <li>The Delphes input is preferably from event data store, but can be in
principal read-in from
<a href="http://lcgapp.cern.ch/project/simu/HepMC/">HepMC</a> data file.</li>
  <li>The Delphes output objects (collections, relations) are written out
through standard
<strong><a href="https://github.com/HEP-FCC/fcc-edm" title="FCC-EDM">FCC-EDM</a></strong> (FCC
event-data model) library. Thus, can be then easily processed by
other framework reconstruction/analysis modules or written out to
<a href="https://root.cern.ch/root/html604/TTree.html" title="ROOT tree">ROOT
tree</a> format.</li>
  <li>In addition, for backwards compatibility and/or testing purposes the
Delphes output is also supported. The output is in Delphes ROOT tree
format, using standard Delphes ROOT tree writer.</li>
</ul>

<p>FCCSW command file (python script) to run Pythia &amp; Delphes:</p>

<ul>
  <li>
    <dl>
      <dt><a href="https://github.com/HEP-FCC/FCCSW/blob/master/Sim/SimDelphesInterface/options/PythiaDelphes_config.py">PythiaDelphes_config.py</a></dt>
      <dd>set all GAUDI parameters to run Pythia, Delphes &amp; Output
module, i.e. configure Pythia, Delphes and ROOT output branches
(prepared in
<a href="https://github.com/HEP-FCC/FCCSW/tree/master/Sim/SimDelphesInterface/options">Sim/SimDelphesInterface/options</a> directory)</dd>
    </dl>
  </li>
</ul>

<p>Pythia configuration file(s), 2 use cases prepared in
<a href="https://github.com/HEP-FCC/FCCSW/tree/master/Generation/data" title="Generation/options">Generation/data</a>
directory:</p>

<ul>
  <li>
    <dl>
      <dt><a href="https://github.com/HEP-FCC/FCCSW/blob/master/Generation/data/Pythia_LHEinput.cmd" title="Pythia_LHEinput.cmd">Pythia_LHEinput.cmd</a></dt>
      <dd>read-in by Pythia-module the LHE file (generated by Madgraph,
etc.), set Pythia configuration</dd>
    </dl>
  </li>
  <li>
    <dl>
      <dt><a href="https://github.com/HEP-FCC/FCCSW/blob/master/Generation/data/Pythia_standard.cmd" title="Pythia_standard.cmd">Pythia_standard.cmd</a></dt>
      <dd>no input, set Pythia configuration</dd>
    </dl>
  </li>
</ul>

<p>Delphes configuration card - use an official experiment card located in
<a href="https://github.com/HEP-FCC/FCCSW/tree/master/Sim/SimDelphesInterface/data">Sim/SimDelphesInterface/data</a>
directory:</p>

<ul>
  <li>
    <dl>
      <dt><a href="https://github.com/HEP-FCC/FCCSW/blob/master/Sim/SimDelphesInterface/data/FCChh_DelphesCard_WithDipole_v00.tcl">FCChh_DelphesCard_WithDipole_v00.tcl</a></dt>
      <dd>FCC-hh detector desctription - option with dipole in the forward
region</dd>
    </dl>
  </li>
  <li>
    <dl>
      <dt><a href="https://github.com/HEP-FCC/FCCSW/blob/master/Sim/SimDelphesInterface/data/FCChh_DelphesCard_WithoutDipole_v00.tcl">FCChh_DelphesCard_WithoutDipole_v00.tcl</a></dt>
      <dd>FCC-hh detector desctription - option without dipole in the
forward region</dd>
    </dl>
  </li>
</ul>

<p>Program workflow:</p>

<p><img src="https://twiki.cern.ch/twiki/pub/FCC/FccPythiaDelphes/PythiaDelphes_ZDrasal_Scheme.jpg" alt="PythiaDelphes_ZDrasal_Scheme.jpg" title="PythiaDelphes_ZDrasal_Scheme.jpg" />{width=”675”
height=”343”}</p>

<h2 id="installation-procedure"><a href=""></a> Installation Procedure</h2>

<p>The analysis is run within a <strong>FCCSW framework</strong> , based on <strong>Gaudi</strong> .
The framework is linked against <strong>Pythia,</strong> <strong>Delphes, FCC-EDM, PODIO,</strong>
… libraries. All the necessary compile tools (CMake, gcc, …) and
up-to-date libraries are properly installed on <strong>lxplus</strong> machines, in a
FCC dedicated storage area. Thus, one only needs to install the FCCSW
framework. For detailed instructions see <a href="https://github.com/HEP-FCC/FCCSW#installation" title="FCCSW installation instructions">FCCSW installation
instructions</a>
.</p>

<p>To get familiar with the <strong>Delphes software</strong> , follow a <a href="https://cp3.irmp.ucl.ac.be/projects/delphes/wiki/WorkBook/QuickTour">quick
tour</a>
on the Delphes official web page. Let us stress that the Delphes card
needs to be compatible with the Delphes software version. Only in such
case, the support for parametrization and physics object output of all
Delphes modules can be guaranteed!</p>

<h2 id="how-to-run"><a href=""></a> How to Run?</h2>

<p>Login to lxplus machine and <strong>don’t forget</strong> to source <strong>init.sh</strong> ,
anytime you log in!</p>

<p><code class="highlighter-rouge"><span class="p">{</span><span class="err">style=</span><span class="nt">"padding-left: 30px;"</span><span class="err">}</span><span class="w">
</span><span class="err">cd</span><span class="w"> </span><span class="err">FCCSW</span><span class="w">
</span><span class="err">source</span><span class="w"> </span><span class="err">init.sh</span><span class="w">
</span></code></p>

<p>First, start with the configuration files, adjust them accordingly:</p>

<ul>
  <li><strong>PythiaDelphes_config.py</strong> : FCCSW run config file –&gt; defines
input/output, main algorithms running (i.e. Pythia &amp; Delphes),
Pythia starting configuration, Delphes detector/running sequence
configuration …
    <ul>
      <li>Variables to be set-up:</li>
      <li><code class="highlighter-rouge">             nEvents           </code> –&gt; events to be simulated</li>
      <li><code class="highlighter-rouge">             messageLevel           </code> –&gt; GAUDI messaging
verbosity: ERROR, WARNING, INFO, DEBUG, … –&gt; use WARNING
or INFO</li>
      <li><code class="highlighter-rouge">             pythiaconfFile           </code> –&gt; Pythia
configuration file (use either Pythia_LHEinput.cmd
or Pythia_standard.cmd)</li>
      <li><code class="highlighter-rouge">             delphesCard           </code> –&gt; Delphes
configuration file (use official Delphes card)</li>
      <li><code class="highlighter-rouge">             delphesHepMCInFile           </code> –&gt; Delphes
input file (use “” to read <span class="twikiNewLink"> HepMC
</span> directly from Pythia, i.e. from transient data store)</li>
      <li><code class="highlighter-rouge">             delphesRootOutFile           </code> –&gt; Delphes
output file (use “” to avoid extra output with Delphes objects
to ROOT file, FCC-EDM objects automatically written out!)</li>
      <li><code class="highlighter-rouge">             delphes???OutArray           </code> –&gt; Define
Delphes output arrays to be processed as FCC-EDM ??? particles
(muons, electrons, etc.) –&gt; various Delphes modules provide
the same type of particle with different level of processing.
(For better understanding, watch the content of the Delphes card
and search e.g. for muons to see how individual Delphes modules
work out muon particles. Focus on
`      OutputArray     ` variable.)</li>
    </ul>
  </li>
  <li><strong>Pythia_LHEinput.cmd</strong> : An example of Pythia configuration to
execute and work-out (process &amp; hadronize) LHE event-data file
(provided by e.g. Madgraph etc.)
    <ul>
      <li>Variables to be set-up:</li>
      <li><code class="highlighter-rouge">             PartonLevel:MPI = on/off           </code> –&gt; Switch
on/off Multi-Particle-Interaction</li>
      <li><code class="highlighter-rouge">             PartonLevel:ISR = on/off           </code> –&gt; Switch
on/off Initial-State-Radiation</li>
      <li><code class="highlighter-rouge">             PartonLevel:FSR = on/off           </code> –&gt; Switch
on/off Final-State-Radiation</li>
      <li><code class="highlighter-rouge">             HadronLevel:all = on/off           </code> –&gt; Switch
on/off Hadronization</li>
      <li><code class="highlighter-rouge">             HadronLevel:Decay = on/off           </code> –&gt;
Switch on/off Decays</li>
      <li><code class="highlighter-rouge">             Beams:LHEF = data/name.lhe           </code> –&gt;
Define LHE event data file</li>
    </ul>
  </li>
  <li><strong>Pythia_standard.cmd</strong> : An example of standard Pythia
configuration to start generation.
    <ul>
      <li>Variables to be set-up (different from those already described
for Pythia_LHEinput.cmd):</li>
      <li><code class="highlighter-rouge">             Random:setSeed = on           </code> –&gt; Apply
user-set seed everytime the Pythia::init is called</li>
      <li><code class="highlighter-rouge">             Random:seed = 0           </code> –&gt; Set seed:
-1=default seed, 0=seed based on time, &gt;0 user seed number</li>
    </ul>
  </li>
  <li><strong>FCChh_DelphesCard_*vXX.tcl</strong> : Official FCChh Delphes
configuration card, defining sequence of Delphes modules to be
executed and detector characterization.</li>
</ul>

<p><strong>Run FCCSW</strong> using the following command:</p>

<p><code class="highlighter-rouge"><span class="p">{</span><span class="err">style=</span><span class="nt">"padding-left: 30px;"</span><span class="err">}</span><span class="w">
</span><span class="err">./run</span><span class="w"> </span><span class="err">gaudirun.py</span><span class="w"> </span><span class="err">Sim/SimDelphesInterface/options/PythiaDelphes_config.py</span><span class="w">
</span></code></p>

<h2 id="fcc-edm-output"><a href=""></a> FCC-EDM output</h2>

<p>The following collections and relations will be saved in the output
file. Each collection (relation) is handled in the FCCSW through a
dedicated handle. For reference, the handle name (specified in a
<a href="https://github.com/HEP-FCC/FCCSW/blob/master/Sim/SimDelphesInterface/options/PythiaDelphes_config.py">DelphesPythia_config.py</a>
file) is given in the brackets [] below:</p>

<ul>
  <li><strong>Collections:</strong>\
    <ul>
      <li><code class="highlighter-rouge">             fcc::MCParticleCollection           </code> –&gt;
generated particles `      [genParticles]     `</li>
      <li><code class="highlighter-rouge">             fcc::GenVertexCollection           </code> –&gt;
generated vertices `      [genVertices]     `</li>
      <li><code class="highlighter-rouge">             fcc::GenJetCollection           </code> –&gt; generated
jets `      [genJets]     `</li>
      <li><code class="highlighter-rouge">             fcc::ParticleCollection           </code> –&gt;
reconstructed muons `      [muons]     ` , electrons
`      [electrons]     ` , charged particles
`      [charged]     ` , neutral particles
`      [neutral]     ` , photons `      [photons]     ` and jet
constituents `      [jetParts]     `</li>
      <li><code class="highlighter-rouge">             fcc::JetCollection           </code> –&gt;
reconstructed jets `      [jets]     `</li>
      <li><code class="highlighter-rouge">             fcc::METCollection           </code> –&gt;
reconstructed missing Et `      [met]     `</li>
      <li><code class="highlighter-rouge">             fcc::IntTagCollection           </code> –&gt; flavour
tag of generated `      [genJetsFlavor]     ` or reconstructed
jets `      [jetsFlavor]     ` , i.e. PDG of leading constituent</li>
      <li><code class="highlighter-rouge">             fcc::TagCollection           </code> –&gt;
reconstructed tags - b-tags, c-tags and tau-tags for jets
`      [bTags, cTags, tauTags]     `</li>
      <li><code class="highlighter-rouge">             fcc::TagCollection           </code> –&gt;
reconstructed isolation tag info for electrons, muons and
photons `      [muonITags, electronITags, photonITags]     `</li>
    </ul>
  </li>
  <li><strong>Relations:</strong>
    <ul>
      <li><code class="highlighter-rouge">             fcc::ParticleMCParticleAssociationCollection           </code>
–&gt; relations of reconstructed object to MC particle for
muons `      [muonsToMC]     ` , electrons
`      [electronsToMC]     ` , charged particles
`      [chargedToMC]     ` , neutral particles
`      [neutralToMC]     ` and photons
`      [photonsToMC]     `</li>
      <li><code class="highlighter-rouge">             fcc::ParticleTagAssociationCollection           </code>
–&gt; relations of reconstructed particles: muons, electrons
and photons to their isolation tag info
`      [muonsToITags, electronsToITags, photonsToITags]     `</li>
      <li><code class="highlighter-rouge">             fcc::GenJetParticleAssociationCollection           </code>
–&gt; relations of generated jet to MC particle
`      [genJetsToMC]     `</li>
      <li><code class="highlighter-rouge">             fcc::GenJetIntTagAssociationCollection           </code>
–&gt; relations of generated jets to the flavour (PDG of the
leading constituent) `      [genJetsToFlavor]     `</li>
      <li><code class="highlighter-rouge">             fcc::JetParticleAssociationCollection           </code>
–&gt; relations of jet to particle constituents
`      [jetsToParts]     `</li>
      <li><code class="highlighter-rouge">             fcc::JetIntTagAssociationCollection           </code>
–&gt; relations of jets to the flavour (PDG of the leading
constituent) `      [jetsToFlavor]     `</li>
      <li><code class="highlighter-rouge">             fcc::JetTagAssociationCollection           </code>
–&gt; relations of jets to reconstructed tags - b-tag, c-tag,
tau-tag `      [jetsToBTags, jetsToCTags, jetsToTauTags]     `</li>
    </ul>
  </li>
</ul>

<h2 id="other-documentation"><a href=""></a> Other documentation</h2>

<p>For more details, you can have a look at:</p>

<ul>
  <li><a href="https://indico.cern.ch/event/446602/contribution/6/attachments/1238094/1818990/PythiaDelphes_ZDrasal.pdf">Talk</a>
(FCC-hh group) on Mar 3rd 2016</li>
  <li><a href="https://indico.cern.ch/event/443015/contribution/2/attachments/1155286/1660371/PythiaDelphes_ZDrasal.pdf">Talk</a>
(FCC-hh group) on Sep 15th 2015</li>
  <li><a href="https://indico.cern.ch/event/399484/contribution/0/attachments/800169/1096662/FCCSW_MDG_040615.pdf">Talk</a>
(FCC software group) on Jun 4th 2015</li>
  <li><a href="https://indico.cern.ch/event/370378/contribution/2/attachments/736634/1010596/FCCSW_MDG_050215.pdf">Talk</a>
(FCC sofware group) on Feb 5th 2015</li>
</ul>

<hr />

<p>Maintainers: <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#122;&#098;&#121;&#110;&#101;&#107;&#046;&#100;&#114;&#097;&#115;&#097;&#108;&#064;&#099;&#101;&#114;&#110;&#083;&#080;&#065;&#077;&#078;&#079;&#084;&#046;&#099;&#104;">Zbynek Drasal</a></p>

<p>– <span class="twikiNewLink"> <span class="wikiUser ZbynekDrasal">
ZbynekDrasal </span> </span> - 2016-03-09</p>

      </div>
      <div class="col-md-2">    <ul class="list-group">
        <li class="list-group-header">
            <h4>External links</h4>
        </li>
        
            <li class="list-group-item">
                <a href='http://cern.ch/simba3/SelfSubscription.aspx?groupName=fcc-experiments-sw-dev'>FCCSW Mailing list</a>
            </li>
        
            <li class="list-group-item">
                <a href='https://sft.its.cern.ch/jira/projects/FCC/'>FCCSW Jira Tracker</a>
            </li>
        
            <li class="list-group-item">
                <a href='https://github.com/HEP-FCC/'>FCCSW on GitHub</a>
            </li>
        
            <li class="list-group-item">
                <a href='https://phsft-jenkins.cern.ch/view/FCC/'>FCCSW Jenkins</a>
            </li>
        
            <li class="list-group-item">
                <a href='https://github.com/HEP-FCC/FCCSW/blob/master/doc/CppCodingStyleGuidelines.md'>FCCSW C++ Style Guide</a>
            </li>
        
            <li class="list-group-item">
                <a href='https://github.com/HEP-FCC/FCCSW/blob/master/doc/GeneralCppGuidelines.md'>General C++ Guidelines</a>
            </li>
        
    </ul>
</div>
    </div>
    <script src="http://fccsw.web.cern.ch/fccsw/node_modules/jquery/dist/jquery.min.js"></script>
<script src="http://fccsw.web.cern.ch/fccsw/node_modules/bootstrap-sass/assets/javascripts/bootstrap.min.js"></script>


  </body>
</html>
